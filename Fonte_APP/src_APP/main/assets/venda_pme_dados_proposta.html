<!DOCTYPE html>
<html lang="pt-br">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="Content-Language" content="pt-br">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1">

		<title>Odontoprev</title>

		<link href="css/bootstrap.min.css" rel="stylesheet">
		<link href="css/style.css" rel="stylesheet">
		<link href="css/odontoprev.css" rel="stylesheet">
	</head>
	
  <body>   
	<!-- Menu -->
	  <div class="closeNav hide" onclick="closeNav()"></div>
	  <div id="mySidenav" class="sidenav">
		  <div class="row">
			  <div class="col-md-12 userLog">
				  <div class="col-md-12">
					  <div class="perfilMenu">
						  <img src="img/icone_325x325.png" class="imgPerfil" alt="">
						  <div>
							  <label class="labelOdontMenu">Rosário Lopes</label>
						  </div>
						  <div>
							  <label class="subLabelOdontMenu">Corretora XPTO</label>
						  </div>
					  </div>
				  </div>
			  </div>
		  </div>
		  <a href="logado.html" class="linkMenu"><img src="img/menu-home.png" align="center">TELA INICIAL</a>
		  <a href="venda_index_pf.html" class="linkMenu"><img src="img/menu-vender-pf.png" align="center">VENDER PESSOA FÍSICA</a>
		  <a href="venda_index_pme.html" class="linkMenu colorActive"><img src="img/menu-vender-pme.png" align="center">VENDER PME</a>
		  <a href="rede_credenciada.html" class="linkMenu"><img src="img/menu-rede-credenciada.png" align="center">BUSCAR REDE CREDENCIADA</a>
		  <a href="lista_proposta.html" class="linkMenu"><img src="img/menu-listas.png" align="center">LISTA DE PROPOSTA</a>
		  <!-- <a href="#" class="linkMenu"><img src="img/menu-listas.png" align="center">INFORMAÇÕES DOS PLANOS</a> -->
		  <a href="meus_dados.html" class="linkMenu"><img src="img/menu-meus-dados.png" align="center">MEUS DADOS</a>
		  <a href="fale_conosco.html" class="linkMenu"><img src="img/menu-contato.png" align="center">FALE CONOSCO</a>
		  <a href="index.html" class="linkMenu"><img src="img/sair.png" class="sair" width="20px" height="20px" align="center">SAIR</a>
	  </div>
	<!-- End Menu -->

	<!-- Bloco 1 -->
		<div class="container-fluid">
			<div class="row">
				<div class="col-md-12 boxHeader">
					<div class="col-md-12 text-left imgLogoODPVHeader">
						<img src="img/logoODPV-header.png" class="" alt="Logo ODPV Header">
					</div>
					<span class="btnMenu" onclick="openNav()">&#9776;</span>
				</div>
			</div>
			<div class="col-md-12 odontBoxCenter">
				<div class="row">
					<div class="text-center">
						<div>
							<h1 class="titleOdont text-center">
								DADOS DA PROPOSTA
							</h1>
							<h2 class="subTitleOdont text-center">
								Confira o plano escolhido e preencha os dados do cliente abaixo
							</h2>
						</div>
					</div>
				</div>
				<div class="row div-excluir">
					<div class="imgBtnExcluir">
						<img src="img/btn-excluir.png" class="btnExcluir" alt="">
					</div>
					<div class="col-md-12 boxDadosProposta">
						<div class="col-md-6 text-left">
							<label class="labelFormPag colorSlick3">Integral DOC LALE</label>
							<label class="labelTipo">Modalidade Livre Adesão</label>
						</div>
						<div class="col-md-6 text-right">
							<label class="formPagVal colorSlick3 font-moeda">R$ 37,<span class="font-cent">82</span></label>
						</div>
					</div>
				</div>
				<div class="text-center">
					<a href="venda_index_pme.html"><label for="senha" class="linkOdontAddPlanos colorSlick3">+ ADICIONAR MAIS PLANOS</label></a>
				</div>

				<form id="formulario-proposta" name="dadosProposta">
				<div class="boxDependente">
					<div>
						<label class="labelBlue">DADOS DA EMPRESA</label>
					</div>
					<div>
						<label class="label-cnpj labelOdontBlur">CNPJ</label>
					</div>
					<div>
						<input type="text" class=" cnpj inputLabelBlur" id="cnpjEmpresa" name="cnpj">
					</div>
					<div>
						<label class="label-razao-social labelOdontBlur">Razão social</label>
					</div>
					<div>
						<input type="text" class="razao-social inputLabelBlur" id="razao-social" name="razaoSocial">
					</div>
					<div>
						<label class="label-nome-fantasia labelOdontBlur">Nome fantasia</label>
					</div>
					<div>
						<input type="text" class="nome-fantasia inputLabelBlur" id="nome-fantasia" name="nomeFantasia">
					</div>
					<div>
						<label class="label-ramo-atividade labelOdontBlur">Ramo de atividade</label>
					</div>
					<div>
						<input type="text" class="ramo-atividade inputLabelBlur" id="ramo-atividade" name="ramoAtividade">
					</div>
					<div>
						<label class="label-inscricao-estadual labelOdontBlur">Inscrição estadual</label>
					</div>
					<div>
						<input type="text" class="inscricao-estadual inputLabelBlur" id="inscricao-estadual" maxlength="14" name="inscricaoEstadual">
					</div>
					<div>
						<label class="label-representante-legal labelOdontBlur">Representante legal</label>
					</div>
					<div>
						<input type="text" class="representante-legal inputLabelBlur" id="representante-legal" name="representanteLegal">
					</div>
					<div>
						<label class="label-cpf labelOdontBlur">CPF</label>
					</div>
					<div>
						<input type="text" class="cpf inputLabelBlur" id="cpf-representante" name="cpfRepresentante">
					</div>
					<div>
						<label class="label-telefone labelOdontBlur">Telefone</label>
						<img src="img/editar.png" width="20px" height="20px" class="edit" alt="Editar">
					</div>
					<div>
						<input type="text" class="telefone inputLabelBlur" name="telefone">
					</div>
					<div>
						<label class="label-celular labelOdontBlur">Celular</label>
						<img src="img/editar.png" width="20px" height="20px" class="edit" alt="Editar">
					</div>
					<div>
						<input type="text" class="celular inputLabelBlur" name="celular">
					</div>
					<div>
						<label class="label-email labelOdontBlur">E-mail</label>
						<img src="img/editar.png" width="20px" height="20px" class="edit" alt="Editar">
					</div>
					<div>
						<input type="text" class="email inputLabelBlur" id="email">
					</div>
					
					<!-- <input type="checkbox" value="" class="exemplo2 checkbox inputLabelFocus">
					<label class="Label-checkbox labelOdontFocus checkbox-inline">
						
					</label> -->

					<div class="squaredOne">
						<input checked type="checkbox" value="True" id="squaredOne" name="representanteLegal" class="checkbox inputLabelCheckFocus"/>
						<label for="squaredOne" class="Label-checkbox labelCheckOdontFocus checkbox-inline">
							<span class="spanCheckbox">
								O representante legal é o contato na empresa
							</span>
						</label>
					</div>
					<div>
						<label class="labelBlue">ENDEREÇO DA EMPRESA</label>
					</div>
					<div>
						<label class="label-cep labelOdontBlur">CEP</label>
						<img src="img/editar.png" width="20px" height="20px" class="edit" alt="Editar">
					</div>
					<div>
						<input type="text" class="cep inputLabelBlur" id="cep" name="cep">
					</div>
					<div>
						<label class="label-endereco labelOdontBlur">Endereço</label>
						<img src="img/editar.png" width="20px" height="20px" class="edit" alt="Editar">
					</div>
					<div>
						<input type="text" class="endereco inputLabelBlur" id="rua" name="rua">
					</div>
					<div>
						<label class="label-numero labelOdontBlur">Número</label>
						<img src="img/editar.png" width="20px" height="20px" class="edit" alt="Editar">
					</div>
					<div>
						<input type="number" class="numero inputLabelBlur" name="numeroEndereco">
					</div>
					<div>
						<label class="label-complemento labelOdontBlur">Complemento</label>
						<img src="img/editar.png" width="20px" height="20px" class="edit" alt="Editar">
					</div>
					<div>
						<input type="text" class="complemento inputLabelBlur" name="complemento">
					</div>
					<div>
						<label class="label-bairro labelOdontBlur">Bairro</label>
						<img src="img/editar.png" width="20px" height="20px" class="edit" alt="Editar">
					</div>
					<div>
						<input type="text" class="bairro inputLabelBlur" id="bairro" name="bairro">
					</div>
					<div>
						<label class="label-cidade labelOdontBlur">Cidade</label>
						<img src="img/editar.png" width="20px" height="20px" class="edit" alt="Editar">
					</div>
					<div>
						<input type="text" class="cidade inputLabelBlur" id="cidade" name="cidade">
					</div>	
					<div>
						<label class="label-estado labelOdontBlur">Estado</label>
						<img src="img/editar.png" width="20px" height="20px" class="edit" alt="Editar">
					</div>
					<div>
						<input type="text" class="estado inputLabelBlur" id="uf" name="uf">
					</div>
					<div class="squaredTwo">
						<input checked type="checkbox" value=True id="squaredTwo" name="enderecoCorrespondencia" class="checkbox inputLabelCheckFocus"/>
						<label for="squaredTwo" class="Label-checkbox labelCheckOdontFocus checkbox-inline">
							<span class="spanCheckbox">
								O endereço de correspondência é o mesmo
							</span>
						</label>
					</div>
				</form>
				<div class="row">
					<div class="col-md-12 btnPadBtm">	 
						<button class="btn btn-lg btn-block btnOdont" id="" role="button" disabled>SALVAR</button>
					</div>
				</div>
				</div>
			


				

				<!-- Buscar CNPJ se estiver Online e trás dados pré preenchidos -->
				<div class="row hide">
					<div class="col-md-12 btnPadBtm">	 
						<a href="" class="btn btn-lg btn-block btnOdont" id="" role="button">BUSCAR CNPJ</a>
					</div>
				</div>
				<!-- End Buscar CNPJ se estiver Online e trás dados pré preenchidos -->

				<!-- Offline habilita este botão e esconde os outros  -->

				<!-- End Offline habilita este botão e esconde os outros  -->

				<div class="row">
					<div class="col-md-12 btnPadBtm" >	 
						<button class="btn btn-lg btn-block btnOdont" disabled id="#adicionar-beneficiario" role="button" onclick="validarProposta()">ADICIONAR BENEFICIÁRIOS</button>
					</div>
				</div>
			</div>
		</div>
	<!-- End Bloco 1 -->
		<script src="js/jquery.min.js"></script>
		<script src="js/bootstrap.min.js"></script>
		<script src="js/scripts.js"></script>
		<script src="js/odontoprev.js"></script>
		<script src="js/jquery.3.2.1.js"></script>
		<script src="js/jquery.mask.min.js"></script>
		<script src="js/odonto-Valida.js"></script>

		<script type="text/javascript">

			// Mantém os inputs em cache:
			var inputs = $('input');

			// Chama a função de verificação quando as entradas forem modificadas
			// Usei o 'keyup', mas 'change' ou 'keydown' são também eventos úteis aqui
			inputs.on('keyup', verificarInputs);

			function verificarInputs() 
			{
    			var preenchidos = true;  // assumir que estão preenchidos
    			inputs.each(function () {
        		// verificar um a um e passar a false se algum falhar
				// no lugar do if pode-se usar alguma função de validação, regex ou outros
				var id = this.id;
				//console.log(id);
				if(id != "razao-social" && id != "nome-fantasia" && id != "ramo-atividade" && id != "inscricao-estadual" && id != "representante-legal"
				&& id != "cpf-representante")
				{
        			if (!this.value || !validaCnpj( $("#cnpjEmpresa").val() )) {
						  preenchidos = false;
						  $('button').prop('disabled', preenchidos);
          				// parar o loop, evitando que mais inputs sejam verificados sem necessidade
          				return false;
					}
				}
    			});
    			// Habilite, ou não, o <button>, dependendo da variável:
				$('button').prop('disabled', !preenchidos); //,
				return true; 
			}			


			function callSerasa(callback, cnpj) 
			{
            	$.ajax({
                	async: true,
                	crossDomain: true,
                	url: "https://sitenethomologa.serasa.com.br:443/experian-data-licensing-ws/dataLicensingService",
                	method: "POST",
                	headers: {
                    	"Content-Type": "application/xml",
                    	"Cache-Control": "no-cache"
                	},
                	data: "<soapenv:Envelope \n\txmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" \n\txmlns:dat=\"http://services.experian.com.br/DataLicensing/DataLicensingService/\" \n\txmlns:dat1=\"http://services.experian.com.br/DataLicensing/\">\n<soapenv:Header>\n            <wsse:Security  xmlns:wsse=\n                        \"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd\">\n            <wsse:UsernameToken>\n                        <wsse:Username>81935697</wsse:Username>\n            <wsse:Password Type=\n                        \"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText\">Prj@2018</wsse:Password>\n            </wsse:UsernameToken>\n            </wsse:Security>\n   </soapenv:Header>\n   <soapenv:Body>\n      <dat:ConsultarPJ>\n         <parameters>\n            <cnpj>" + cnpj + "</cnpj>\n            <RetornoPJ>\n               <razaoSocial>true</razaoSocial>\n               <nomeFantasia>true</nomeFantasia>\n               <endereco>true</endereco>\n               <dataAbertura>true</dataAbertura>\n               <representanteLegal>true</representanteLegal>\n               <cnae>true</cnae>\n               <telefone>true</telefone>\n               <situacaoCadastral>ONLINE</situacaoCadastral>\n               <simplesNacional>ONLINE</simplesNacional>\n            </RetornoPJ>\n         </parameters>\n      </dat:ConsultarPJ>\n   </soapenv:Body>\n</soapenv:Envelope>",
                	success: function (resp) {
                    callback(resp)
                	},
            	});
        	}

    		$('#cnpjEmpresa').blur(function() {
    	
    			buscarEmpresa();
        	});

        	function buscarEmpresa() {

        		var cnpjValidado = $('#cnpjEmpresa').val().replace(/\D/g, '');

            	callSerasa(function (dataConsulta)
            	{ 
					try{        
					$("#nome-fantasia").val(dataConsulta.getElementsByTagName("nomeFantasia")[0].textContent);                        
					$("#razao-social").val(dataConsulta.getElementsByTagName("razaoSocial")[0].textContent);
					$("#ramo-atividade").val(dataConsulta.getElementsByTagName("descricao")[0].textContent);
					$("#representante-legal").val(dataConsulta.getElementsByTagName("nome")[0].textContent);
					$("#cpf-representante").val(dataConsulta.getElementsByTagName("documento")[0].textContent);
					}
					catch(Exception)
					{
						console.log(Exception);
					}			

            	}, cnpjValidado);
			}

			function validarProposta()
			{
				if (verificarInputs()) 
				{
					console.log("Executou a function e entro no if");
					window.localStorage.setItem('quantidadeBeneficiarios', 0);				
					var jsonProposta = JSON.stringify($("#formulario-proposta").serializeArray());
					window.localStorage.setItem('Proposta', jsonProposta);
					
					window.location="venda_pme_beneficiarios.html";
					
					//href="venda_pme_beneficiarios.html" 
				}
				else console.log("Erro");
			}
				

		</script>>
  </body>
</html>